(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{287:function(e,a,t){e.exports=t(566)},292:function(e,a,t){},552:function(e,a){},562:function(e,a,t){},566:function(e,a,t){"use strict";t.r(a);var r=t(0),n=t.n(r),s=t(4),o=t.n(s),l=(t(292),t(16)),c=t(179),i=t.n(c),m=t(260),u=t(37),p=t.n(u),d="login_user",h="register_user",g="auth_user",f="logout_user",E="get_group_chat",v="get_chat",b="after_post_message",y="/api/users",w="/api/chat";var N=t(30),x=function(e,a){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return function(s){var o=Object(N.d)(function(e){return e.user}),l=Object(N.c)();return Object(r.useEffect)(function(){l(function(){var e=p.a.get("".concat(y,"/auth")).then(function(e){return e.data});return{type:g,payload:e}}()).then(function(){var e=Object(m.a)(i.a.mark(function e(r){return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,!r.payload.isAuth;case 2:if(!e.sent){e.next=6;break}a&&s.history.push("/register_login"),e.next=7;break;case 6:t&&!r.payload.isAdmin?s.history.push("/"):!1===a&&s.history.push("/");case 7:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}())},[l,s.history,o.googleAuth]),n.a.createElement(e,Object.assign({},s,{user:o}))}};var O=function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"app"}))},C=t(70),S=t(136),j=t(35),k=t(573),_=t(572),I=t(577),D=t(9),P=t(575),M=t(185),q=k.a.Title;var T=Object(l.f)(function(e){var a=Object(N.c)(),t=!!localStorage.getItem("rememberMe"),s=Object(r.useState)(""),o=Object(C.a)(s,2),l=o[0],c=o[1],i=Object(r.useState)(t),m=Object(C.a)(i,2),u=m[0],h=m[1],g=function(){h(!u)},f=localStorage.getItem("rememberMe")?localStorage.getItem("rememberMe"):"";return n.a.createElement(S.a,{initialValues:{email:f,password:""},validationSchema:j.object().shape({email:j.string().email("Email is invalid").required("Email is required"),password:j.string().min(6,"Password must be at least 6 characters").required("Password is required")}),onSubmit:function(t,r){var n=r.setSubmitting;setTimeout(function(){var r={email:t.email,password:t.password};a(function(e){var a=p.a.post("".concat(y,"/login"),e).then(function(e){return e.data});return{type:d,payload:a}}(r)).then(function(a){a.payload.loginSuccess?(!0===u?window.localStorage.setItem("rememberMe",t.id):localStorage.removeItem("rememberMe"),e.history.push("/")):c("Check out your Account or Password again")}).catch(function(e){c("Check out your Account or Password again"),setTimeout(function(){c("")},3e3)}),n(!1)},500)}},function(e){var a=e.values,t=e.touched,r=e.errors,s=(e.dirty,e.isSubmitting),o=e.handleChange,c=e.handleBlur,i=e.handleSubmit;return e.handleReset,n.a.createElement("div",{className:"app"},n.a.createElement(q,{level:2},"Log In"),n.a.createElement("form",{onSubmit:i,style:{width:"350px"}},n.a.createElement(_.a.Item,{required:!0},n.a.createElement(I.a,{id:"email",prefix:n.a.createElement(D.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Enter your email",type:"email",value:a.email,onChange:o,onBlur:c,className:r.email&&t.email?"text-input error":"text-input"}),r.email&&t.email&&n.a.createElement("div",{className:"input-feedback"},r.email)),n.a.createElement(_.a.Item,{required:!0},n.a.createElement(I.a,{id:"password",prefix:n.a.createElement(D.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Enter your password",type:"password",value:a.password,onChange:o,onBlur:c,className:r.password&&t.password?"text-input error":"text-input"}),r.password&&t.password&&n.a.createElement("div",{className:"input-feedback"},r.password)),l&&n.a.createElement("label",null,n.a.createElement("p",{style:{color:"#ff0000bf",fontSize:"0.7rem",border:"1px solid",padding:"1rem",borderRadius:"10px"}},l)),n.a.createElement(_.a.Item,null,n.a.createElement(P.a,{id:"rememberMe",onChange:g,checked:u},"Remember me"),n.a.createElement("a",{className:"login-form-forgot",href:"/reset_user",style:{float:"right"}},"forgot password"),n.a.createElement("div",null,n.a.createElement(M.a,{type:"primary",htmlType:"submit",className:"login-form-button",style:{minWidth:"100%"},disabled:s,onSubmit:i},"Log in")),"Or ",n.a.createElement("a",{href:"/register"},"register now!"))))})}),G=t(38),L=t.n(G),B={labelCol:{xs:{span:24},sm:{span:8}},wrapperCol:{xs:{span:24},sm:{span:16}}},F={wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}};var R=function(e){var a=Object(N.c)();return n.a.createElement(S.a,{initialValues:{email:"",lastName:"",name:"",password:"",confirmPassword:""},validationSchema:j.object().shape({name:j.string().required("Name is required"),lastName:j.string().required("Last Name is required"),email:j.string().email("Email is invalid").required("Email is required"),password:j.string().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:j.string().oneOf([j.ref("password"),null],"Passwords must match").required("Confirm Password is required")}),onSubmit:function(t,r){var n=r.setSubmitting;setTimeout(function(){var r={email:t.email,password:t.password,name:t.name,lastname:t.lastname,image:"http://gravatar.com/avatar/".concat(L()().unix(),"?d=identicon")};a(function(e){var a=p.a.post("".concat(y,"/register"),e).then(function(e){return e.data});return{type:h,payload:a}}(r)).then(function(a){a.payload.success?e.history.push("/login"):alert(a.payload.err.errmsg)}),n(!1)},500)}},function(e){var a=e.values,t=e.touched,r=e.errors,s=(e.dirty,e.isSubmitting),o=e.handleChange,l=e.handleBlur,c=e.handleSubmit;return e.handleReset,n.a.createElement("div",{className:"app"},n.a.createElement("h2",null,"Sign up"),n.a.createElement(_.a,Object.assign({style:{minWidth:"375px"}},B,{onSubmit:c}),n.a.createElement(_.a.Item,{required:!0,label:"Name"},n.a.createElement(I.a,{id:"name",placeholder:"Enter your name",type:"text",value:a.name,onChange:o,onBlur:l,className:r.name&&t.name?"text-input error":"text-input"}),r.name&&t.name&&n.a.createElement("div",{className:"input-feedback"},r.name)),n.a.createElement(_.a.Item,{required:!0,label:"Last Name"},n.a.createElement(I.a,{id:"lastName",placeholder:"Enter your Last Name",type:"text",value:a.lastName,onChange:o,onBlur:l,className:r.lastName&&t.lastName?"text-input error":"text-input"}),r.lastName&&t.lastName&&n.a.createElement("div",{className:"input-feedback"},r.lastName)),n.a.createElement(_.a.Item,{required:!0,label:"Email",hasFeedback:!0,validateStatus:r.email&&t.email?"error":"success"},n.a.createElement(I.a,{id:"email",placeholder:"Enter your Email",type:"email",value:a.email,onChange:o,onBlur:l,className:r.email&&t.email?"text-input error":"text-input"}),r.email&&t.email&&n.a.createElement("div",{className:"input-feedback"},r.email)),n.a.createElement(_.a.Item,{required:!0,label:"Password",hasFeedback:!0,validateStatus:r.password&&t.password?"error":"success"},n.a.createElement(I.a,{id:"password",placeholder:"Enter your password",type:"password",value:a.password,onChange:o,onBlur:l,className:r.password&&t.password?"text-input error":"text-input"}),r.password&&t.password&&n.a.createElement("div",{className:"input-feedback"},r.password)),n.a.createElement(_.a.Item,{required:!0,label:"Confirm",hasFeedback:!0},n.a.createElement(I.a,{id:"confirmPassword",placeholder:"Enter your confirmPassword",type:"password",value:a.confirmPassword,onChange:o,onBlur:l,className:r.confirmPassword&&t.confirmPassword?"text-input error":"text-input"}),r.confirmPassword&&t.confirmPassword&&n.a.createElement("div",{className:"input-feedback"},r.confirmPassword)),n.a.createElement(_.a.Item,F,n.a.createElement(M.a,{onClick:c,type:"primary",disabled:s},"Submit"))))})},V=t(273),A=t(274),W=t(100),z=t(284),Y=t(282),H=t(570),U=t(571),X=t(275),J=t.n(X);var $=t(568),K=t(569),Q=t(101);var Z=function(e){return n.a.createElement("div",{style:{width:"100%"}},n.a.createElement($.a,{author:e.sender.name,avatar:n.a.createElement(K.a,{src:e.sender.image,alt:e.sender.name}),content:"uploads/"===e.message.substring(0,8)?"mp4"===e.message.substring(e.message.length-3,e.message.length)?n.a.createElement("video",{style:{maxWidth:"200px"},src:"http://localhost:5000/".concat(e.message),alt:"video",type:"video/mp4",controls:!0}):n.a.createElement("img",{style:{maxWidth:"200px"},src:"http://localhost:5000/".concat(e.message),alt:"img"}):n.a.createElement("p",null,e.message),datetime:n.a.createElement(Q.a,{title:L()().format("YYYY-MM-DD HH:mm:ss")},n.a.createElement("span",null,L()().fromNow()))}))},ee=t(281);function ae(){var e=n.a.useRef(""),a=n.a.useRef(""),t=Object(r.useState)(!1),s=Object(C.a)(t,2),o=s[0],l=s[1];return n.a.createElement("section",{className:"section search"},n.a.createElement("h3",null,"Create a Group"),n.a.createElement("div",{className:"form-style-5"},n.a.createElement("form",{className:"search-form"},n.a.createElement("div",{className:"form-control"},n.a.createElement("label",{htmlFor:"name"},"Title"),n.a.createElement("input",{type:"text",name:"titleValue",id:"titleValue",ref:e}),n.a.createElement("label",{htmlFor:"name"},"Description"),n.a.createElement("input",{type:"text",name:"descriptionValue",id:"descriptionValue",ref:a}),n.a.createElement(M.a,{type:"primary",style:{width:"30%"},onClick:function(t){var r={title:e.current.value,description:a.current.value};console.log(r);var n={method:"POST",body:JSON.stringify(r),headers:{"Content-type":"application/json; charset=UTF-8"}};fetch("api/chat/addgroup",n).then(function(e){return e.json()}).then(function(e){return console.log(e)}),l(!o)},htmlType:"submit"},"Submit Group")))))}var te=function(e){Object(z.a)(t,e);var a=Object(Y.a)(t);function t(e){var r;return Object(V.a)(this,t),(r=a.call(this,e)).handleSearchChange=function(e){r.setState({chatMessage:e.target.value})},r.onDrop=function(e){if(console.log(e),r.props.user.userData&&!r.props.user.userData.isAuth)return alert("Please Log in first");var a=new FormData;a.append("file",e[0]),p.a.post("api/chat/uploadfiles",a,{header:{"content-type":"multipart/form-data"}}).then(function(e){if(e.data.success){var a=e.data.url,t=r.props.user.userData._id,n=r.props.user.userData.name,s=r.props.user.userData.image,o=L()();r.socket.emit("Input Chat Message",{chatMessage:a,userId:t,userName:n,userImage:s,nowTime:o,type:"VideoOrImage"})}})},r.submitChatMessage=function(e){if(e.preventDefault(),r.props.user.userData&&!r.props.user.userData.isAuth)return alert("Please Log in first");var a=r.state.chosengroup,t=r.state.chatMessage,n=r.props.user.userData._id,s=r.props.user.userData.name,o=r.props.user.userData.image,l=L()();r.socket.emit("Input Chat Message",{chatMessage:t,userId:n,userName:s,groupId:a,userImage:o,nowTime:l,type:"Text"}),r.setState({chatMessage:""})},r.state={chatMessage:"",groups:[],chosengroup:"",group:{}},r.handleGroupChange=r.handleGroupChange.bind(Object(W.a)(r)),r.getGroupChat=r.getGroupChat.bind(Object(W.a)(r)),fetch("/api/chat/getGroups").then(function(e){return e.json()}).then(function(e){console.log("groups"),console.log(e),r.setState({groups:e})}),r}return Object(A.a)(t,[{key:"handleGroupChange",value:function(e){e.target.value;this.setState({chosengroup:e.target.value}),console.log("/api/chat"),this.getGroupChat(e.target.value)}},{key:"getGroupChat",value:function(e){var a=this;fetch("".concat("/api/chat","/getChats/").concat(e)).then(function(e){return e.json()}).then(function(e){return a.props.dispatch(function(e){return{type:E,payload:e}}(e))})}},{key:"componentDidMount",value:function(){var e=this;this.props.dispatch(function(){var e=p.a.get("".concat(w,"/getChats")).then(function(e){return e.data});return{type:v,payload:e}}()),this.socket=J()("http://localhost:5000"),this.socket.on("Output Chat Message",function(a){console.log(a),e.props.dispatch({type:b,payload:a})})}},{key:"componentDidUpdate",value:function(){this.messagesEnd.scrollIntoView({behavior:"smooth"})}},{key:"render",value:function(){var e=this,a=n.a.createElement("p",null,"No conversation so far.");this.props.chats.chats&&(a=this.props.chats.chats.map(function(e){return n.a.createElement(Z,Object.assign({key:e._id},e))}));var t=n.a.createElement("option",{value:"no groups"},"no groups");return this.state.groups&&(t=this.state.groups.map(function(e){return n.a.createElement("option",{key:e._id,value:e._id},e.title)})),n.a.createElement(n.a.Fragment,null,n.a.createElement("div",null,n.a.createElement("p",{style:{fontSize:"2rem",textAlign:"center"}}," Real Time Chat")),n.a.createElement("h2",null,"Choose a Group"),n.a.createElement("div",{className:"form-style-5"},n.a.createElement("form",{onSubmit:this.setGroup},n.a.createElement("div",{className:"form-control"},n.a.createElement("label",{htmlFor:"room"},"Room"),n.a.createElement("select",{name:"room",id:"room",onChange:this.handleGroupChange},t)))),n.a.createElement("div",{style:{maxWidth:"800px",margin:"0 auto"}},n.a.createElement("div",{className:"infinite-container",style:{height:"500px",overflowY:"scroll"}},a,n.a.createElement("div",{ref:function(a){e.messagesEnd=a},style:{float:"left",clear:"both"}})),n.a.createElement(H.a,null,n.a.createElement(_.a,{layout:"inline",onSubmit:this.submitChatMessage},n.a.createElement(U.a,{span:18},n.a.createElement(I.a,{id:"message",prefix:n.a.createElement(D.a,{type:"message",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Let's start talking",type:"text",value:this.state.chatMessage,onChange:this.handleSearchChange})),n.a.createElement(U.a,{span:2},n.a.createElement(ee.a,{onDrop:this.onDrop},function(e){var a=e.getRootProps,t=e.getInputProps;return n.a.createElement("section",null,n.a.createElement("div",a(),n.a.createElement("input",t()),n.a.createElement(M.a,null,n.a.createElement(D.a,{type:"upload"}))))})),n.a.createElement(U.a,{span:4},n.a.createElement(M.a,{type:"primary",style:{width:"100%"},onClick:this.submitChatMessage,htmlType:"submit"},n.a.createElement(D.a,{type:"enter"})))))),n.a.createElement(ae,null))}}]),t}(r.Component),re=Object(N.b)(function(e){return{user:e.user,chats:e.chat}})(te),ne=t(574);ne.a.SubMenu,ne.a.ItemGroup;var se=function(e){return n.a.createElement(ne.a,{mode:e.mode},n.a.createElement(ne.a.Item,{key:"mail"},n.a.createElement("a",{href:"/"},"Home")),n.a.createElement(ne.a.Item,{key:"chat"},n.a.createElement("a",{href:"/chat"},"Chat")))};var oe=Object(l.f)(function(e){var a=Object(N.d)(function(e){return e.user});return a.userData&&!a.userData.isAuth?n.a.createElement(ne.a,{mode:e.mode},n.a.createElement(ne.a.Item,{key:"mail"},n.a.createElement("a",{href:"/login"},"Signin")),n.a.createElement(ne.a.Item,{key:"app"},n.a.createElement("a",{href:"/register"},"Signup"))):n.a.createElement(ne.a,{mode:e.mode},n.a.createElement(ne.a.Item,{key:"logout"},n.a.createElement("a",{onClick:function(){p.a.get("".concat(y,"/logout")).then(function(a){200===a.status?e.history.push("/login"):alert("Log Out Failed")})}},"Logout")))}),le=t(576);t(562);var ce=function(){var e=Object(r.useState)(!1),a=Object(C.a)(e,2),t=a[0],s=a[1];return n.a.createElement("nav",{className:"menu",style:{position:"fixed",zIndex:1,width:"100%"}},n.a.createElement("div",{className:"menu__logo"},n.a.createElement("a",{href:"/"},"Logo")),n.a.createElement("div",{className:"menu__container"},n.a.createElement("div",{className:"menu_left"},n.a.createElement(se,{mode:"horizontal"})),n.a.createElement("div",{className:"menu_rigth"},n.a.createElement(oe,{mode:"horizontal"})),n.a.createElement(M.a,{className:"menu__mobile-button",type:"primary",onClick:function(){s(!0)}},n.a.createElement(D.a,{type:"align-right"})),n.a.createElement(le.a,{title:"Basic Drawer",placement:"right",className:"menu_drawer",closable:!1,onClose:function(){s(!1)},visible:t},n.a.createElement(se,{mode:"inline"}),n.a.createElement(oe,{mode:"inline"}))))};var ie=function(){return n.a.createElement("div",{style:{height:"80px",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",fontSize:"1rem"}})};var me=function(){return n.a.createElement(r.Suspense,{fallback:n.a.createElement("div",null,"Loading...")},n.a.createElement(ce,null),n.a.createElement("div",{className:"content_wrapper",style:{paddingTop:"75px",minHeight:"calc(100vh - 80px)"}},n.a.createElement(l.c,null,n.a.createElement(l.a,{exact:!0,path:"/",component:x(O,null)}),n.a.createElement(l.a,{exact:!0,path:"/chat",component:x(re,null)}),n.a.createElement(l.a,{exact:!0,path:"/login",component:x(T,!1)}),n.a.createElement(l.a,{exact:!0,path:"/register",component:x(R,!1)}))),n.a.createElement(ie,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ue=t(96),pe=t(69),de=t(25),he=Object(pe.c)({user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;switch(a.type){case h:return Object(de.a)(Object(de.a)({},e),{},{register:a.payload});case d:return Object(de.a)(Object(de.a)({},e),{},{loginSucces:a.payload});case g:return Object(de.a)(Object(de.a)({},e),{},{userData:a.payload});case f:return Object(de.a)({},e);default:return e}},chat:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=arguments.length>1?arguments[1]:void 0;switch(a.type){case v:return Object(de.a)(Object(de.a)({},e),{},{chats:a.payload});case E:return console.log("groupid in reducer"),console.log(a.payload),Object(de.a)(Object(de.a)({},e),{},{chats:a.payload});case b:return Object(de.a)(Object(de.a)({},e),{},{chats:e.chats.concat(a.payload)});default:return e}}}),ge=t(279),fe=t.n(ge),Ee=t(280),ve=Object(pe.a)(fe.a,Ee.a)(pe.d);o.a.render(n.a.createElement(N.a,{store:ve(he,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())},n.a.createElement(ue.a,null,n.a.createElement(me,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[287,1,2]]]);
//# sourceMappingURL=main.f8d1553d.chunk.js.map